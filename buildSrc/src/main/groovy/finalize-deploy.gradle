
def isSnapshot = version.endsWith("-SNAPSHOT")
def isMilestone = !isSnapshot && (version.contains("-M") || version.contains("-RC"))

def finalizeDeployArtifacts = project.task("finalizeDeployArtifacts")
if (!isSnapshot && !isMilestone && project.hasProperty("ossrhUsername")) {
    project.ext.nexusUsername = project.ossrhUsername
    project.ext.nexusPassword = project.ossrhPassword
    finalizeDeployArtifacts.dependsOn 'closeAndReleaseRepository'
    project.nexusStaging {
        packageGroup = 'io.spring'

        // try for 5 minutes total
        numberOfRetries = 60 // default is 20
        delayBetweenRetriesInMillis = 5000 // default is 2000
    }
}
